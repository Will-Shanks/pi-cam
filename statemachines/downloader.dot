digraph {
  d_a_start->d_d [label="New Thread", color=blue]
  d_d->d_s [label="Connection established"]
  d_s->d_clean [label="Request Serviced/Connection Terminated"]
  d_clean->d [color=red]

  d_a_stop->d_clean [label="Signal Thread", color=red, style=dashed]

  d_d [label="Listen for TCP connection on port D_PORT"]
  d_s [label="Write request to connection"]
  d_clean [label="Close Socket, Recording File"]

  d [label="Kill Thread", style=filled, fillcolor=grey]

  subgraph cluster_d_a{
    label="Downloader API"
    d_a_start [label="Request Download", shape=box]
    d_a_stop [label="Cancel Download", shape=box]
  }
}
